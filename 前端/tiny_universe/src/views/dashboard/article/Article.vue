<template>
  <div class="article-all" >
    <el-container>
      <el-aside width="130px">
        <el-scrollbar style="height:510px;position: fixed;top: 130px">
          <div class="tag-div">
            <el-radio-group class="tag-all" border="false" v-model="onTag" size="large">
              <el-radio-button class="tag-item"
                               label="全部" :value="-1" />
              <el-radio-button class="tag-item" v-for="(tag,index) in tags" :key="index"
                               :label="tag.name" :value="tag.id" />
            </el-radio-group>
          </div>
        </el-scrollbar>
      </el-aside>
      <el-main>
        <el-space alignment="flex-start" :size="50">

          <div class="article-list">
            <!--TODO: 相同组件，传递不同的参数，选择下面的菜单格式-->
            <el-menu
                class="el-menu-demo"
                mode="horizontal"
                :ellipsis="false"
                active-text-color="#00f0fc"
                router
                :default-active="path"
            >
              <!--@select="handleSelect" -->
              <el-menu-item index="/dashboard/article/list/0" id="热门">
                <svg t="1725980889871" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4249" width="32" height="32"><path d="M552.96 921.6a368.64 368.64 0 0 1-325.632-541.4912 20.48 20.48 0 1 1 36.2496 19.2512A327.68 327.68 0 1 0 880.64 552.96a20.48 20.48 0 0 1 40.96 0 368.64 368.64 0 0 1-368.64 368.64z" fill="#0090FF" p-id="4250"></path><path d="M901.12 573.44a20.48 20.48 0 0 1-6.5536-1.024 163.84 163.84 0 0 1-109.1584-94.8224c-20.48-55.5008-6.3488-116.9408 8.192-156.0576-75.1616 34.816-118.5792 155.0336-118.9888 156.2624a20.48 20.48 0 0 1-30.1056 10.4448c-130.6624-81.92-118.5792-275.6608-102.4-373.76C464.896 184.32 322.3552 340.5824 406.7328 481.0752A20.48 20.48 0 0 1 389.12 512c-3.4816 0-85.1968 2.4576-132.096-43.008A106.7008 106.7008 0 0 1 225.28 389.12a20.48 20.48 0 0 1 40.96 0 66.3552 66.3552 0 0 0 20.48 50.3808 130.2528 130.2528 0 0 0 68.8128 29.0816c-33.3824-83.968-11.6736-180.4288 63.8976-281.1904a765.3376 765.3376 0 0 1 143.36-143.36A20.48 20.48 0 0 1 593.92 66.7648c0 2.8672-69.0176 266.24 53.0432 372.3264 22.9376-51.4048 83.968-163.84 182.272-167.5264a20.48 20.48 0 0 1 18.432 9.6256 20.48 20.48 0 0 1 0 20.48s-50.3808 91.3408-23.552 161.1776a124.928 124.928 0 0 0 83.7632 70.4512A20.48 20.48 0 0 1 901.12 573.44z" fill="#0090FF" p-id="4251"></path></svg>
                <h1>热门</h1>
              </el-menu-item>
              <el-menu-item index="/dashboard/article/list/1" id="最新">
                <svg t="1725980857400" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4295" width="32" height="32"><path d="M1006.762667 443.682133l-129.0752 324.488533-109.806933 0c4.864-39.645867 12.151467-91.886933 21.8624-156.740267-10.5472 28.535467-22.186667 57.309867-34.9696 86.3232l-30.3616 70.417067-110.062933 0 45.806933-324.488533 87.1936 0c-1.655467 8.482133-11.2128 70.417067-28.689067 185.838933 4.352-11.8784 28.859733-73.8304 73.5232-185.838933l83.7632 0L845.653333 629.504c18.0736-54.272 42.734933-116.206933 74.001067-185.838933L1006.762667 443.665067zM608.768 603.8016l-138.666667 0-20.309333 78.4384c-4.2496 16.401067-5.8368 26.965333-4.7616 31.709867 1.0752 4.744533 4.881067 7.099733 11.4176 7.099733 8.123733 0 14.370133-3.140267 18.7392-9.4208 4.369067-6.280533 8.891733-18.449067 13.550933-36.488533l12.3904-47.8208 101.546667 0-6.929067 26.7776c-5.802667 22.408533-11.6224 39.6288-17.476267 51.6608-5.853867 12.032-15.581867 24.866133-29.201067 38.536533-13.6192 13.6704-29.0304 23.9104-46.267733 30.737067-17.237333 6.826667-37.512533 10.257067-60.842667 10.257067-22.6304 0-41.728-3.3792-57.309867-10.103467-15.581867-6.741333-26.658133-15.991467-33.245867-27.733333-6.587733-11.758933-9.915733-24.695467-9.966933-38.8096-0.0512-14.114133 3.413333-34.6624 10.3936-61.627733l27.374933-105.762133c8.209067-31.709867 18.8416-56.712533 31.880533-75.025067 13.038933-18.312533 30.293333-32.341333 51.729067-42.0864 21.435733-9.745067 44.4416-14.626133 69.000533-14.626133 30.0544 0 53.316267 5.870933 69.802667 17.629867 16.4864 11.758933 26.146133 27.323733 28.996267 46.728533 2.833067 19.4048-0.290133 46.6944-9.386667 81.851733L608.768 603.8016zM520.209067 473.719467c-7.424 0-12.629333 2.321067-15.581867 6.9632-2.9696 4.642133-7.099733 17.169067-12.373333 37.5808L485.376 544.768l31.2832 0 6.8608-26.504533c4.864-18.773333 7.0144-30.890667 6.485333-36.352C529.493333 476.450133 526.216533 473.719467 520.209067 473.719467zM431.342933 400.503467c-23.6032 10.376533-42.5984 25.2928-56.951467 44.782933-14.370133 19.490133-26.077867 46.08-35.106133 79.8208l-30.1568 112.5376c-7.68 28.689067-11.502933 50.551467-11.434667 65.570133 0.068267 15.018667 3.720533 28.791467 10.973867 41.284267 7.253333 12.509867 19.456 22.340267 36.608 29.508267 0.7168 0.290133 1.536 0.494933 2.2528 0.785067l-2.884267 10.496-128.529067 0-7.867733-248.4736L139.844267 785.271467 17.237333 785.271467l150.493867-546.56 122.606933 0 14.4384 246.101333 67.771733-246.101333 122.606933 0-42.427733 154.112C445.457067 394.990933 438.289067 397.448533 431.342933 400.503467z" fill="#5CBDEE" p-id="4296"></path></svg>
                <h1>最新</h1>
              </el-menu-item>
              <el-menu-item index="/dashboard/article/list/2" id="推荐">
                <svg t="1725980912565" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8345" width="32" height="32"><path d="M70.267586 359.918345c-39.406345 0-70.267586 33.633103-70.267586 73.533793v499.358896C0 972.658759 30.75531 1006.344828 70.285241 1006.344828h175.845518V395.22869l-4.660966 17.566896a2667.714207 2667.714207 0 0 1 31.408552-52.577103 2488.108138 2488.108138 0 0 1 75.369931-115.994483 1438.596414 1438.596414 0 0 1 47.633655-65.05931C440.461241 122.067862 477.925517 88.275862 489.454345 88.275862c83.508966 0 99.522207 36.034207 76.570483 127.205517-4.449103 17.655172-10.24 36.281379-18.220138 59.409655-3.124966 9.004138-13.506207 38.258759-14.936276 42.372414-5.59669 16.066207-9.216 27.365517-11.828966 37.376-3.760552 14.653793-5.296552 26.164966-3.65462 37.252414 3.283862 22.192552 20.303448 38.664828 44.049655 38.664828h350.596414c33.31531 0 49.540414 24.823172 37.552551 63.117241L837.702621 851.508966c-14.336 45.832828-63.417379 84.215172-105.648552 84.215172H210.838069v70.62069h521.216c73.992828 0 149.751172-59.233103 173.056-133.755587l111.880828-357.835034c25.63531-82.008276-21.945379-154.835862-104.96-154.835862H561.434483c13.064828 0 24.205241 10.769655 25.811862 21.645241 0.088276 0.653241 0.582621-3.072 2.189241-9.268965 1.977379-7.662345 5.12-17.44331 10.116414-31.779311 1.324138-3.813517 11.758345-33.191724 15.006897-42.584276 8.580414-24.858483 14.918621-45.250207 19.950344-65.200551C667.17131 102.964966 629.21269 17.655172 489.43669 17.655172c-43.431724 0-89.458759 41.489655-149.221518 118.042483a1507.87531 1507.87531 0 0 0-49.999448 68.272552 2556.998621 2556.998621 0 0 0-77.541517 119.33131 2737.928828 2737.928828 0 0 0-32.485517 54.377931l-4.660966 8.15669V971.034483l35.310345-35.310345h-140.535172C71.238621 935.724138 70.62069 433.452138 70.62069 433.452138c0-2.189241 140.217379-2.913103 140.217379-2.913104v-70.620689H70.267586z" fill="#389BFF" p-id="8346"></path></svg>
                <h1>推荐</h1>
              </el-menu-item>
              <el-button style="margin: 12px 20px 0 200px;" @click="toArticleEditor">发布文章</el-button>
            </el-menu>
            <!--TODO：key解决在同一组件只改变路由参数而不刷新组件的问题-->
            <router-view :key="route.path" :reloadArticleList="reloadArticleList" v-if="isViewAlive"></router-view>
          </div>
          <el-space class="imgObj" :size="50" direction="vertical" style="position: fixed;top: 130px">
            <img src="@/assets/海报1.png" alt="" width="350"/>
            <img src="@/assets/海报2.png" alt="" width="350"/>
          </el-space>
        </el-space>
      </el-main>
    </el-container>
  </div>
</template>
<script setup>

// 文章相关操作
import {ElMessage} from "element-plus";
import {doGet} from "@/http/httpRequest.js";
import {onMounted, provide, ref} from "vue";
import {useRoute, useRouter} from "vue-router";
import {newRoute} from "@/util/router.js";
import {reloadUtil} from "@/util/util.js";
let tags = ref([]);
let onTag = ref(-1);
let router = useRouter();
let route = useRoute();
let path = route.path;
let isViewAlive = ref(true);
onMounted(() => {
  if(!route.path.includes('list')){
    router.push('/dashboard/article/list/0');
  }
  getTags();
})
const reloadArticleList = () => {
  reloadUtil(isViewAlive);
}
const getTags = () => {
  doGet("/tag",{name:''}).then((resp) => {
    if(resp.data.code === 1){
      tags.value = resp.data.data;
    }else{
      ElMessage.error("服务器繁忙");
    }
  });
}
const toArticleEditor = () => {
  newRoute("/dashboard/article_editor/-1",router);
}
provide("tag",onTag);

</script>

<style>
body{
  font-family: Roboto;
}

.imgObj img{
  max-width: 350px;
  min-width: 350px;
}
.article-all{
  position: relative;
  max-width: 100%;
  overflow-x: auto;
}
.tag-div{
  height: 513px;
  width: 105px;
}
.el-radio-button{
  padding: 10px 10px;
}
.el-radio-button .el-radio-button__inner{
  border: none!important;
  font-size: 20px!important;
}

.el-radio-button .el-radio-button__original-radio:checked+.el-radio-button__inner {
  background-color: rgba(234, 242, 255, 0.2);
  color: var(--common-color);
}
.tag-all{
  display: flex;
  flex-direction: column;
}
.el-scrollbar{
  margin-left: 20px;
  background: var(--main-beside-color);
  /*position: fixed*/;
}
.tag-item:hover{
  color: var(--common-color);
}
.article-tag{
  padding: 25px 25px 25px 0;
  width: 100px;
  max-height: 600px;
}

.article-list{
  padding: 10px 25px;
  position: relative;
  background: var(--main-beside-color);
  display: flex;
  flex-direction: column;
  width:1000px;
}
</style>
